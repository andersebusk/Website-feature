const PdfContent = document.getElementById('pdf-content');
    const htmlTemplate = `
    <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Template</title>
    <style>
        :root{
          --customColor: rgb(38, 96, 147);
          --customColor2: rgb(92, 140, 183);
          --customColor3: rgb(163, 201, 97);
          --font-color: black;
          --highlight-color: var(--customColor);
          --header-bg-color: var(--customColor2);
          --footer-bg-color: var(--customColor3);
          --table-row-separator-color: #BFC0C3;
        }
        @page{
          size:A4;
          margin:0;
          @top-left{
            content:element(header);
          }
          @bottom-left{
            content:element(footer);
          }
        }
        body{
          margin:0;
          padding:1cm 2cm;
          color:var(--font-color);
          font-family: 'Montserrat', sans-serif;
          font-size:10pt;
        }
        a{
          color:inherit;
          text-decoration:none;
        }
        hr{
          margin:1cm 0;
          height:0;
          border:0;
          border-top:1mm solid var(--highlight-color);
        }
        header{
          height:8cm;
          padding:0 2cm;
          position:running(header);
          background-color:var(--header-bg-color);
        }
        header .headerSection{
          display:flex;
          justify-content:space-between;
        }
        header .headerSection:first-child{
          padding-top:.5cm;
        }
        header .headerSection:last-child{
          padding-bottom:.5cm;
        }
        header .headerSection div:last-child{
          width:35%;
        }
        header .logoAndName{
          display:flex;
          align-items:center;
          justify-content:space-between;
        }
        header .logoAndName svg{
          width:1.5cm;
          height:1.5cm;
          margin-right:.5cm;
        }
        header .headerSection .estimateDetails{
          padding-top:1cm;
        }
        header .headerSection .issuedTo{
          display:flex;
          justify-content:space-between;
        }
        header .headerSection .issuedTo h3{
          margin:0 .75cm 0 0;
          color:var(--highlight-color);
        }
        header .headerSection div p{
          margin-top:2px;
        }
        header h1,
        header h2,
        header h3,
        header p{
          margin:0;
        }
        header h2,
        header h3{
          text-transform:uppercase;
        }
        header hr{
          margin:1cm 0 .5cm 0;
        }
        main table{
          width:100%;
          border-collapse:collapse;
        }
        main table thead th{
          height:1cm;
          color:var(--highlight-color);
        }
        main table thead th:nth-of-type(2),
        main table thead th:nth-of-type(3),
        main table thead th:last-of-type{
          width:2.5cm;
        }
        main table tbody td{
          padding:2mm 0;
          border-bottom:0.5mm solid var(--table-row-separator-color);
        }
        main table thead th:last-of-type,
        main table tbody td:last-of-type{
          text-align:right;
        }
        main table th{
          text-align:left;
        }
        main table.summary{
          width:calc(40% + 2cm);
          margin-left:60%;
          margin-top:.5cm;
        }
        main table.summary tr.total{
          font-weight:bold;
          background-color:var(--highlight-color);
        }
        main table.summary th{
          padding:4mm 0 4mm 1cm;
          border-bottom:0;
        }
        main table.summary td{
          padding:4mm 2cm 4mm 0;
          border-bottom:0;
        }
        aside{
          -prince-float: bottom;
          float: none;
          padding:0 2cm .5cm 2cm;
        }
        aside p{
          margin:0;
          column-count:2;
        }
        footer{
          height:3cm;
          line-height:3cm;
          padding:0 2cm;
          position:running(footer);
          background-color:var(--footer-bg-color);
          font-size:8pt;
          display:flex;
          align-items:baseline;
          justify-content:space-between;
        }
        footer a:first-child{
          font-weight:bold;
        }
    </style>
</head>
<body>
<header>
    <div class="headerSection">
      <div class="logoAndName">
        <svg>
          <circle cx="50%" cy="50%" r="40%" stroke="black" stroke-width="3" fill="black" />
        </svg>
        <h1>Marine Fluid Technology</h1>
      </div>
      <div>
        <h2>Savings overview</h2>
        <p>
          <b>Date Issued</b> 
          <script>
            document.write(new Date().toLocaleDateString());
          </script>
        </p>
      </div>
    </div>
    <hr />
    <div class="headerSection">
      <div id= userinfo class="issuedTo">
        <h3>Issued to</h3>
        <p>
          <span id="companyOutput"></span> <br/>
          <span id="mailOutput"></span> <br/>
          <span id="phoneOutput"></span> <br/>
          <span id="countryOutput"></span>
        </p>
      </div>
      <div>
        <p>
          <b>Notes</b>
          <br />
          Please contact us, if you have any questions regarding the savings overview.
        </p>
      </div>
    </div>
  </header>
  
  <footer>
      <a href="https://marinefluid.dk/">https://marinefluid.dk/</a>
      <span>+45 2476 9512</span>
      <span>Strandvejen 60, 2900 Hellerup, Denmark</span>
  </footer>
  
  <main>
    <table>
      <thead>
        <tr>
          <th>Item Description</th>
          <th>Rate</th>
          <th></th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <b>Savings in USD due to installing the BOB</b>
            <br />
            Total in USD 
          </td>
          <td>
            <span id="usdOutput"></span>
          </td>
          <td>
            <span id="usdOutput"></span>
            </td>
            <td>
              
            </td>
          </tr>
          <tr>
            <td>
              <b>Tonnes of CO2 saved:</b>
              <br />
              Tonnes of CO2
            </td>
            <td>
              
            </td>
            <td>
              <span id="co2OutPut"></span>
            </td>
            <td>
              <span id="co2OutPut"></span>
            </td>
          </tr>
          <tr>
            <td>
              <b>Litres of oil saved:</b>
              <br />
              Litres of oil
            </td>
            <td>
              
            </td>
            <td>
              <span id="litersOutput"></span>
            </td>
            <td>
              <span id="litersOutput"></span>
            </td>
          </tr>
        </tbody>
      </table>
      <table class="summary">
        <tr>
          <th>
            
          </th>
          <td>
            
          </td>
        </tr>
        <tr>
          <th>
           
          </th>
          <td>
           
          </td>
        </tr>
        <tr class="total">
          <th>
            Total USD: <br />
            Total CO2: <br />
            Total Litres:
          </th>
          <td>
            <span id="totalUsdOutput"></span> <br />
            <span id="totalCo2Output"></span> <br />
            <span id="totalLitersOutput"></span>
          </td>
        </tr>
      </table>
    </main>
    <aside>
      <hr />
      <b>Terms &amp; Conditions</b>
      <p>
        
      </p>
    </aside>
  </body>
  </html>  
    `;

    const generatePNG = async (htmlTemplate: any) => {
      // Create a new div element
      const temporaryDiv = document.createElement('div');
      // Set its inner HTML to the provided string
      temporaryDiv.innerHTML = htmlTemplate;
      // Append the temporary div to the body
      document.body.appendChild(temporaryDiv);
      // Calculate the scale factor
      const scaleFactor = Math.min(1, window.innerWidth / temporaryDiv.offsetWidth, window.innerHeight / temporaryDiv.offsetHeight);
      // Apply a CSS transform to the temporary div to scale it down
      temporaryDiv.style.transform = `scale(${scaleFactor})`;
      temporaryDiv.style.transformOrigin = 'top left';
      // Use dom-to-image to take a screenshot of the div
      domtoimage.toBlob(temporaryDiv)
        .then((blob) => {
          // Create a new URL for the blob and open it in a new window
          const url = URL.createObjectURL(blob);
          window.open(url, '_blank');
          // Remove the temporary div from the body
          document.body.removeChild(temporaryDiv);
        })
        .catch((error) => {
          console.error('Error converting DOM to image:', error);
        });
    };
    
    generatePNG(htmlTemplate);